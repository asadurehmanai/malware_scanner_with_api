import requests

url = 'https://www.filescan.io/api/scan/file'


class Malware():
    def __init__(self):
        self.flow_id = ""

    def scan_malware(self, filename):
        file_b = open(f'uploads/{filename}', 'rb')
        file = {'file': file_b}
        r = requests.request('POST', url, files=file).json()
        self.flow_id = r["flow_id"]

    def generate_report(self):
        url = f'https://www.filescan.io/api/scan/{self.flow_id}/report'
        response = requests.get(url).json()

        while not response['allFinished']:
            response = requests.get(url).json()

        return response
